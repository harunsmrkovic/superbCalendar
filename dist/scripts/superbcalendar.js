"use strict";angular.module("superbCalendar",[]),angular.module("superbCalendar").controller("SuperbCalendarCtrl",function(a,b){function c(b,c){b=parseInt(b,10),c=parseInt(c,10),c%4===0&&(a.monthsDuration[1]=29);var d,e,f=new Date(c,b-1,1),g=new Date(c,b-1,a.monthsDuration[b-1]),h=0===f.getDay()?7:f.getDay(),i=[];for(e=0;h-1>e;e++)d=1===b?12:b-1,i.unshift({date:[1===b?c-1:c,("0"+d).slice(-2),("0"+(a.monthsDuration[d-1]-e)).slice(-2)].join("-"),prevMonth:!0});for(e=1;e<=a.monthsDuration[b-1];e++)i.push({date:[c,("0"+b).slice(-2),("0"+e).slice(-2)].join("-")});if(g.getDay()>0&&g.getDay()<7)for(e=1;e<=7-g.getDay();e++)i.push({date:[12===b?c+1:c,("0"+(12===b?1:b+1)).slice(-2),("0"+e).slice(-2)].join("-"),nextMonth:!0});return i}function d(a){return parseInt(a.split("-")[1])}a.initialDate?a.initialDate=new Date(a.initialDate):a.initialDate=new Date,a.currentMonth=a.initialDate.getMonth()+1,a.monthsDuration=[31,28,31,30,31,30,31,31,30,31,30,31],a.allMonths=["January","February","March","April","May","June","July","August","September","October","November","December"],a.calendar={},a.calendar[a.currentMonth]=c(a.currentMonth,2015),a.$watchCollection("ranges",function(b){angular.forEach(b,function(b){for(var c=Date.parse(b.startDate),e=Date.parse(b.endDate),f=d(b.startDate),g=d(b.endDate),h=f;g>=h;h++){var i;angular.forEach(a.calendar[h],function(a){i=Date.parse(a.date),i>c&&e>i&&(a.inRange=!0)})}})}),a.showPrevMonth=function(){var b=a.currentMonth-1;a.calendar[b]||(a.calendar[b]=c(b,2015)),a.currentMonth--},a.showNextMonth=function(){var b=a.currentMonth+1;a.calendar[b]||(a.calendar[b]=c(b,2015)),a.currentMonth++},a.clickedDate=function(b){return b.prevMonth?void a.showPrevMonth():b.nextMonth?void a.showNextMonth():(!a.multipleDates,b.selected=!0,void(a.ranges&&(a.rangeStartDate?(b.selected=!0,a.ranges.push({startDate:a.rangeStartDate.date,endDate:b.date}),delete a.rangeStartDate):a.rangeStartDate=b)))},a.hoveringDate=function(b){a.range&&a.rangeStartDate&&(a.hoveringOnDay=b)}}),angular.module("superbCalendar").directive("superbCalendar",function(){return{templateUrl:"views/_calendar.html",restrict:"E",scope:{initialDate:"@",ranges:"=",multipleDates:"@"},controller:"superbCalendarCtrl",link:function(a,b,c){}}}),angular.module("superbCalendar").filter("unixtimestamp",function(){return function(a){return a?new Date(a.replace(/-/g,"/")).getTime():void 0}});